CREATE TRIGGER [dbo].[TRG_UPD_PEDIDO_EXPORT_PDV_LOCAL] 
ON [dbo].[Pedido] 
FOR UPDATE 
AS
BEGIN
	DECLARE @IntNUMERO INT,
		@InPEDIDO INT,
		@INTEGRAÇÃO INT

	SELECT @IntNUMERO = DELETED.NUMERO FROM DELETED JOIN PEDIDO ON PEDIDO.NUMERO = DELETED.NUMERO

	IF (SELECT NumeroLoja FROM deleted WHERE NUMERO = @IntNUMERO) = 0 AND (SELECT NumeroLoja FROM deleted WHERE NUMERO = @IntNUMERO) IS NOT NULL 
		UPDATE PEDIDO SET NumeroLoja = Numero WHERE NUMERO = @IntNUMERO	
  
	IF (SELECT PedidoLoja FROM deleted WHERE NUMERO = @IntNUMERO) = 0 AND (SELECT PedidoLoja FROM deleted WHERE NUMERO = @IntNUMERO) IS NOT NULL 
		UPDATE PEDIDO SET PedidoLoja = Pedido WHERE NUMERO = @IntNUMERO	

	IF (SELECT EnviarLoja FROM deleted WHERE NUMERO = @IntNUMERO) <> 'S' AND (SELECT EnviarLoja FROM deleted WHERE NUMERO = @IntNUMERO) IS NOT NULL 
		UPDATE PEDIDO SET EnviarLoja = 'S' WHERE NUMERO = @IntNUMERO
END	
